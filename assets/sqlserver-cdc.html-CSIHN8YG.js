import{_ as l,r as c,o as d,c as r,a as s,d as n,b as t,e as a}from"./app-CUvyzFzm.js";const o="/document/images/sqlserver-cdc/cdcdataflow.gif",i="/document/images/sqlserver-cdc/E48E7325.png",p="/document/images/sqlserver-cdc/33EB10F7.png",u="/document/images/sqlserver-cdc/5E20673A.png",_="/document/images/sqlserver-cdc/970FAF5E.png",m="/document/images/sqlserver-cdc/3CE944AD.png",v="/document/images/sqlserver-cdc/89548E8B.png",h="/document/images/sqlserver-cdc/D874E031.png",b="/document/images/sqlserver-cdc/6F740C70.png",k={},g=a('<blockquote><p>ğŸ“ƒç‰ˆæœ¬: 1.5</p><p>ğŸ“†æ—¥æœŸ: 2021-11-02</p></blockquote><h1 id="sql-server-å˜æ›´æ•°æ®æ•è·-cdc" tabindex="-1"><a class="header-anchor" href="#sql-server-å˜æ›´æ•°æ®æ•è·-cdc"><span>SQL Server å˜æ›´æ•°æ®æ•è·ï¼ˆCDCï¼‰</span></a></h1><h1 id="_1-cdc-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_1-cdc-ç®€ä»‹"><span>1. CDC ç®€ä»‹</span></a></h1><p>å˜æ›´æ•°æ®æ•è· (CDC) å¯è®°å½•åº”ç”¨äº SQL Server è¡¨çš„æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ´»åŠ¨ã€‚</p><p>å˜æ›´æ•°æ®æ•è·(CDC)çš„<code>æ•è·æ•°æ®æº</code>ä¸º <code>SQL Server äº‹åŠ¡æ—¥å¿—</code></p><p>æµç¨‹å›¾</p><p><img src="'+o+'" alt="å˜æ›´æ•°æ®æ•è·æ•°æ®æµ"></p><ul><li>åœ¨å°†æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤åº”ç”¨äºè·Ÿè¸ªçš„<code>æºè¡¨</code>æ—¶ï¼Œå°†ä¼šåœ¨æ—¥å¿—ä¸­æ·»åŠ è¯´æ˜è¿™äº›æ›´æ”¹çš„é¡¹ã€‚</li><li><code>æ•è·è¿›ç¨‹</code>ä¼šè¯»å–æ—¥å¿—ï¼Œå¹¶åœ¨è·Ÿè¸ªçš„è¡¨çš„å…³è”<code>æ›´æ”¹è¡¨</code>ä¸­æ·»åŠ æœ‰å…³æ›´æ”¹çš„ä¿¡æ¯ã€‚</li><li>ç³»ç»Ÿå°†æä¾›ä¸€äº›<code>å‡½æ•°</code>ï¼Œä»¥æšä¸¾åœ¨æ›´æ”¹è¡¨ä¸­æŒ‡å®šèŒƒå›´å†…å‘ç”Ÿçš„æ›´æ”¹ï¼Œå¹¶ä»¥ç­›é€‰çš„ç»“æœé›†çš„å½¢å¼è¿”å›è¯¥å€¼ã€‚</li></ul>',8),y=s("p",null,[s("strong",null,"å¼•ç”¨")],-1),f={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/track-changes/about-change-data-capture-sql-server?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},x=a(`<hr><h1 id="_2-å‡†å¤‡å·¥ä½œ" tabindex="-1"><a class="header-anchor" href="#_2-å‡†å¤‡å·¥ä½œ"><span>2. å‡†å¤‡å·¥ä½œ</span></a></h1><h2 id="_2-1-åˆ›å»ºcdcæ–‡ä»¶ç»„" tabindex="-1"><a class="header-anchor" href="#_2-1-åˆ›å»ºcdcæ–‡ä»¶ç»„"><span>2.1 åˆ›å»ºCDCæ–‡ä»¶ç»„</span></a></h2><p>ä¸ºäº†æ€§èƒ½æœ€å¤§åŒ–ï¼Œå»ºè®®å°†æ›´æ”¹è¡¨ç½®äºç‹¬ç«‹äºæºè¡¨çš„æ–‡ä»¶ç»„ä¸­ï¼Œå¹¶æ”¾ç½®åœ¨ä¸åŒçš„ç£ç›˜ä¸Šã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> master
GO

<span class="token comment">-- åˆ›å»ºæ–‡ä»¶ç»„ CDCFG</span>
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> AdventureWorks2016
<span class="token keyword">ADD</span> FILEGROUP CDCFG
GO

<span class="token comment">-- æ·»åŠ æ–‡ä»¶ CDCdat1 åˆ° æ–‡ä»¶ç»„ CDCFG</span>
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> AdventureWorks2016
<span class="token keyword">ADD</span> <span class="token keyword">FILE</span>
<span class="token punctuation">(</span>
    NAME <span class="token operator">=</span> CDCdat1<span class="token punctuation">,</span>
    FILENAME <span class="token operator">=</span> <span class="token string">&#39;G:\\Program Files\\Microsoft SQL Server\\MSSQL13.SQL16\\MSSQL\\DATA\\CDCdat1.ndf&#39;</span><span class="token punctuation">,</span>
    SIZE <span class="token operator">=</span> <span class="token number">5</span>MB<span class="token punctuation">,</span>
    MAXSIZE <span class="token operator">=</span> UNLIMITED<span class="token punctuation">,</span>
    FILEGROWTH <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">%</span>
<span class="token punctuation">)</span>
<span class="token keyword">TO</span> FILEGROUP CDCFG<span class="token punctuation">;</span>
GO
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-2-å¯åŠ¨sql-serverä»£ç†æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_2-2-å¯åŠ¨sql-serverä»£ç†æœåŠ¡"><span>2.2 å¯åŠ¨SQL Serverä»£ç†æœåŠ¡</span></a></h2>`,6),q={href:"https://docs.microsoft.com/zh-cn/sql/ssms/agent/start-stop-or-pause-the-sql-server-agent-service?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},E=a(`<blockquote><p><strong>æ³¨æ„</strong></p><p>å¯¹è¡¨å¯ç”¨å˜æ›´æ•°æ®æ•è·æ—¶ï¼ŒSQL Server ä»£ç†ä¸å¿…æ­£åœ¨è¿è¡Œã€‚ ä½†æ˜¯ï¼Œ<strong><u>åªæœ‰å½“ SQL Server ä»£ç†æ­£åœ¨è¿è¡Œæ—¶ï¼Œæ•è·è¿›ç¨‹æ‰ä¼šå¤„ç†äº‹åŠ¡æ—¥å¿—å¹¶å°†æ¡ç›®å†™å…¥æ›´æ”¹è¡¨ã€‚</u></strong></p></blockquote><h2 id="_2-3-æ£€æŸ¥å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è€…" tabindex="-1"><a class="header-anchor" href="#_2-3-æ£€æŸ¥å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è€…"><span>2.3 æ£€æŸ¥å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è€…</span></a></h2><p>å¯ç”¨CDCå‰ï¼Œéœ€è¦å…ˆæ£€æŸ¥å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è€…ï¼Œè‹¥ä¸º<code>null</code>æˆ–è€…é<code>sa</code>ç”¨æˆ·æ—¶ï¼Œåˆ™å»ºè®®å°†æ‰€æœ‰è€…æ›´æ”¹ä¸ºç™»å½•å<code>sa</code>ã€‚</p><p>å¦åˆ™åç»­å¼€å¯CDCæ“ä½œå¯èƒ½å¤±è´¥ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> d<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>owner_sid<span class="token punctuation">,</span> sl<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span><span class="token keyword">databases</span> <span class="token keyword">AS</span> d
	<span class="token keyword">left</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>sql_logins <span class="token keyword">AS</span> sl
		<span class="token keyword">ON</span> d<span class="token punctuation">.</span>owner_sid <span class="token operator">=</span> sl<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
		
<span class="token comment">/* ç»“æœ
name                owner_sid                         name
------------------- --------------------------------- -----------------------------
master              0x01                              sa
tempdb              0x01                              sa
model               0x01                              sa
msdb                0x01                              sa
AdventureWorks2016  0x010500000000000515000           NULL
*/</span>

<span class="token comment">-- AdventureWorks2016 name(æ‰€æœ‰è€…)ä¸ºNULLï¼ˆç©ºï¼‰</span>
<span class="token comment">-- å°†æ‰€æœ‰è€…å˜æ›´æ›´æ”¹ä¸ºç™»å½•åsa</span>
<span class="token keyword">USE</span> <span class="token punctuation">[</span>AdventureWorks2016<span class="token punctuation">]</span>
GO
<span class="token keyword">ALTER</span> <span class="token keyword">AUTHORIZATION</span> <span class="token keyword">ON</span> <span class="token keyword">DATABASE</span>::<span class="token punctuation">[</span>AdventureWorks2016<span class="token punctuation">]</span> <span class="token keyword">TO</span> <span class="token punctuation">[</span>sa<span class="token punctuation">]</span>
GO
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h1 id="_3-å¯ç”¨æ›´æ”¹æ•°æ®æ•è·-cdc-æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_3-å¯ç”¨æ›´æ”¹æ•°æ®æ•è·-cdc-æµç¨‹"><span>3. å¯ç”¨æ›´æ”¹æ•°æ®æ•è·ï¼ˆCDCï¼‰æµç¨‹</span></a></h1><h2 id="_3-1-æ•°æ®åº“å¯ç”¨cdc" tabindex="-1"><a class="header-anchor" href="#_3-1-æ•°æ®åº“å¯ç”¨cdc"><span>3.1 æ•°æ®åº“å¯ç”¨CDC</span></a></h2>`,8),C={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-enable-db-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},w=a(`<div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> AdventureWorks2016  
GO  

<span class="token comment">-- å¯¹å½“å‰æ•°æ®åº“å¯ç”¨å˜æ›´æ•°æ®æ•è·</span>
<span class="token comment">-- æ³¨æ„ï¼šæ— æ³•åœ¨ ç³»ç»Ÿæ•°æ®åº“ æˆ–åˆ†å‘æ•°æ®åº“ä¸Šå¯ç”¨å˜æ›´æ•°æ®æ•è·ã€‚</span>
<span class="token comment">-- is_cdc_enabledï¼šæ˜¯å¦å·²å¯ç”¨CDC</span>
<span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span> <span class="token keyword">SELECT</span>  <span class="token number">1</span> <span class="token keyword">FROM</span> sys<span class="token punctuation">.</span><span class="token keyword">databases</span> <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token string">&#39;AdventureWorks2016&#39;</span> <span class="token operator">and</span> is_cdc_enabled  <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token comment">-- è¿”å›ä»£ç å€¼ </span>
	<span class="token comment">-- 0ï¼ˆæˆåŠŸï¼‰æˆ– 1ï¼ˆå¤±è´¥ï¼‰ </span>
	<span class="token keyword">EXEC</span> sys<span class="token punctuation">.</span>sp_cdc_enable_db 
<span class="token keyword">END</span>
GO
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“å¯¹æ•°æ®åº“æˆåŠŸå¯ç”¨äº†å˜æ›´æ•°æ®æ•è·ä¹‹åï¼š</p><ul><li><p>å¦‚æœæ•°æ®åº“è¿˜åŸåˆ°å…¶ä»–æœåŠ¡å™¨ï¼Œé»˜è®¤æƒ…å†µä¸‹å°†ç¦ç”¨å˜æ›´æ•°æ®æ•è·ï¼Œå¹¶åˆ é™¤æ‰€æœ‰ç›¸å…³çš„å…ƒæ•°æ®ã€‚</p><p>è‹¥è¦ä¿ç•™å˜æ›´æ•°æ®æ•è·ï¼Œè¯·åœ¨è¿˜åŸæ•°æ®åº“æ—¶ä½¿ç”¨ <strong>KEEP_CDC</strong> é€‰é¡¹ã€‚</p></li><li><p>å°† <code>sys.databases</code>ç›®å½•è§†å›¾ä¸­çš„æ•°æ®åº“æ¡ç›®çš„ is_cdc_enabled åˆ—è®¾ç½®ä¸º1</p></li><li><p>å¹¶å°†ä¸ºæ•°æ®åº“åˆ›å»ºä»¥ä¸‹å¯¹è±¡ï¼š</p></li></ul><table><thead><tr><th style="text-align:center;">å…ƒæ•°æ®è¡¨</th><th style="text-align:center;">DDL è§¦å‘å™¨</th><th style="text-align:center;">cdc schemaï¼ˆæ¶æ„ï¼‰</th><th style="text-align:center;">cdc æ•°æ®åº“ç”¨æˆ·</th></tr></thead><tbody><tr><td style="text-align:center;"><img src="`+i+'" alt=""></td><td style="text-align:center;"><img src="'+p+'" alt=""></td><td style="text-align:center;"><img src="'+u+'" alt=""></td><td style="text-align:center;"><img src="'+_+'" alt=""></td></tr></tbody></table><ul><li>å³ä½¿æ¢å¤æ¨¡å¼è®¾ç½®ä¸ºç®€å•æ¢å¤ï¼Œæ—¥å¿—æˆªæ–­ç‚¹ä¹Ÿä¸ä¼šå‘å‰æ¨è¿›ï¼Œç›´åˆ°ä¸ºæ•è·æ ‡è®°çš„æ‰€æœ‰æ›´æ”¹éƒ½å·²ç”±æ•è·è¿›ç¨‹æ”¶é›†ä¸ºæ­¢ã€‚ å¦‚æœæ•è·è¿›ç¨‹æœªè¿è¡Œä¸”æœ‰è¦æ”¶é›†çš„æ›´æ”¹ï¼Œæ‰§è¡Œ CHECKPOINT å°†ä¸ä¼šæˆªæ–­æ—¥å¿—ã€‚</li></ul><h2 id="_3-2-è¡¨å¯ç”¨cdc" tabindex="-1"><a class="header-anchor" href="#_3-2-è¡¨å¯ç”¨cdc"><span>3.2 è¡¨å¯ç”¨CDC</span></a></h2><p>â€‹ å¯¹è¡¨å¯ç”¨å˜æ›´æ•°æ®æ•è·æ—¶ï¼Œåº”ç”¨äºæ­¤è¡¨çš„æ¯ä¸ªæ•°æ®æ“çºµè¯­è¨€ (DML) æ“ä½œçš„è®°å½•éƒ½å°†å†™å…¥äº‹åŠ¡æ—¥å¿—ä¸­ã€‚ å˜æ›´æ•°æ®æ•è·è¿›ç¨‹å°†ä»æ—¥å¿—ä¸­æ£€ç´¢æ­¤ä¿¡æ¯ï¼Œå¹¶å°†å…¶å†™å…¥æ›´æ”¹è¡¨ä¸­ã€‚</p>',7),D={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-enable-table-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},S=a(`<div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> AdventureWorks2016<span class="token punctuation">;</span>  
GO  
<span class="token comment">-- åˆ›å»ºä¸€ä¸ªæ•è·å®ä¾‹</span>
<span class="token keyword">EXEC</span> sys<span class="token punctuation">.</span>sp_cdc_enable_table  
    <span class="token variable">@source_schema</span> <span class="token operator">=</span> N<span class="token string">&#39;HumanResources&#39;</span>  <span class="token comment">-- æºè¡¨æ‰€å±çš„æ¶æ„çš„åç§°(é»˜è®¤dbo)</span>
  <span class="token punctuation">,</span> <span class="token variable">@source_name</span> <span class="token operator">=</span> N<span class="token string">&#39;Department&#39;</span>  		<span class="token comment">-- æºè¡¨çš„åç§°</span>
  <span class="token punctuation">,</span> <span class="token variable">@role_name</span> <span class="token operator">=</span> <span class="token boolean">null</span>  <span class="token comment">-- ç”¨äºè®¿é—®æ›´æ”¹æ•°æ®çš„æ•°æ®åº“è§’è‰²çš„åç§°,nullåˆ™ä¸é™åˆ¶è®¿é—®ã€‚</span>
  <span class="token punctuation">,</span> <span class="token variable">@capture_instance</span> <span class="token operator">=</span> <span class="token boolean">null</span> <span class="token comment">-- æ•è·å®ä¾‹çš„åç§°, nullåˆ™æŒ‰æºæ¶æ„åç§°åŠ ä¸Š schemaname_sourcename æ ¼å¼ç”Ÿæˆã€‚ï¼ˆä¾‹å¦‚HumanResources_Departmentï¼‰ </span>
  <span class="token punctuation">,</span> <span class="token variable">@supports_net_changes</span> <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment">-- æ˜¯å¦ä¸ºæ­¤æ•è·å®ä¾‹å¯ç”¨ç”¨äºæŸ¥è¯¢å‡€æ›´æ”¹çš„æ”¯æŒã€‚</span>
  <span class="token punctuation">,</span> <span class="token variable">@index_name</span> <span class="token operator">=</span> <span class="token boolean">null</span> <span class="token comment">-- ç”¨äºå”¯ä¸€æ ‡è¯†æºè¡¨ä¸­çš„è¡Œçš„å”¯ä¸€ç´¢å¼•çš„åç§°, nullåˆ™å–ä¸»é”®ã€‚</span>
  <span class="token punctuation">,</span> <span class="token variable">@captured_column_list</span> <span class="token operator">=</span> <span class="token boolean">null</span> <span class="token comment">-- æ ‡è¯†è¦æ•è·çš„æºè¡¨åˆ—ï¼ˆé€—å·éš”å¼€â€˜ID,Code,Nameâ€™ï¼‰ï¼ŒNULLåˆ™æ‰€æœ‰åˆ—éƒ½å°†æ•è·ã€‚</span>
  <span class="token punctuation">,</span> <span class="token variable">@filegroup_name</span> <span class="token operator">=</span> N<span class="token string">&#39;CDCFG&#39;</span><span class="token punctuation">;</span>  
GO  

<span class="token comment">/* æ‰§è¡Œç»“æœ
æ¶ˆæ¯
ä½œä¸š &#39;cdc.AdventureWorks2016_capture&#39; å·²æˆåŠŸå¯åŠ¨ã€‚
ä½œä¸š &#39;cdc.AdventureWorks2016_cleanup&#39; å·²æˆåŠŸå¯åŠ¨ã€‚
*/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“å¯¹è¡¨å¯ç”¨å˜æ›´æ•°æ®æ•è·æˆåŠŸä¹‹åä¼šä¿®æ”¹æˆ–åˆ›å»ºä»¥ä¸‹å†…å®¹ï¼š</p><h3 id="_3-2-1-æ•è·å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#_3-2-1-æ•è·å®ä¾‹"><span>3.2.1 æ•è·å®ä¾‹</span></a></h3>`,3),L={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-help-change-data-capture-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},A=a(`<div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> AdventureWorks2016<span class="token punctuation">;</span>  
GO  
<span class="token comment">-- è¿”å› HumanResources.Department è¡¨çš„å˜æ›´æ•°æ®æ•è·å®ä¾‹é…ç½®ã€‚</span>
<span class="token keyword">EXECUTE</span> sys<span class="token punctuation">.</span>sp_cdc_help_change_data_capture   
    <span class="token variable">@source_schema</span> <span class="token operator">=</span> N<span class="token string">&#39;HumanResources&#39;</span><span class="token punctuation">,</span>   
    <span class="token variable">@source_name</span> <span class="token operator">=</span> N<span class="token string">&#39;Department&#39;</span><span class="token punctuation">;</span>  
GO  
<span class="token comment">-- è¿”å› æ‰€æœ‰å¯ç”¨è¡¨çš„å˜æ›´æ•°æ®æ•è·å®ä¾‹é…ç½®ã€‚</span>
<span class="token keyword">EXECUTE</span> sys<span class="token punctuation">.</span>sp_cdc_help_change_data_capture<span class="token punctuation">;</span>  
GO
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-2-sys-tablesè§†å›¾" tabindex="-1"><a class="header-anchor" href="#_3-2-2-sys-tablesè§†å›¾"><span>3.2.2 <code>sys.tables</code>è§†å›¾</span></a></h3><p>æ›´æ–°<code>sys.tables</code>è§†å›¾çš„è¡¨æ¡ç›®ä¸­çš„<code>is_tracked_by_cdc</code> åˆ—ä¸º1.</p><h3 id="_3-2-3-æ›´æ”¹è¡¨" tabindex="-1"><a class="header-anchor" href="#_3-2-3-æ›´æ”¹è¡¨"><span>3.2.3 æ›´æ”¹è¡¨</span></a></h3><p>åˆ›å»ºæ›´æ”¹è¡¨<code>cdc.HumanResources_Department_CT</code>ï¼Œ</p><p>å˜æ›´è¡¨æ˜¯å…³è”<code>æ•è·å®ä¾‹</code>çš„ï¼Œå‘½åæ–¹å¼ä¸ºï¼š&lt;æ•è·å®ä¾‹åç§°&gt;_CTã€‚</p><p><img src="`+m+'" alt=""></p><h3 id="_3-2-4-æŸ¥è¯¢å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#_3-2-4-æŸ¥è¯¢å‡½æ•°"><span>3.2.4 æŸ¥è¯¢å‡½æ•°</span></a></h3><p>åˆ›å»ºæŸ¥è¯¢å‡½æ•°</p>',9),N=s("p",null,[n("æŸ¥è¯¢æ‰€æœ‰æ›´æ”¹å‡½æ•°ï¼š"),s("code",null,"cdc.fn_cdc_get_all_changes_HumanResources_Department")],-1),T={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-functions/cdc-fn-cdc-get-all-changes-capture-instance-transact-sql?view=sql-server-ver15#examples",target:"_blank",rel:"noopener noreferrer"},O=s("p",null,"â€‹ è¿”å›æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å‡ºç°çš„æ‰€æœ‰æ›´æ”¹è¡¨é¡¹ã€‚",-1),G=s("p",null,[n("æŸ¥è¯¢Net changesï¼ˆå‡€æ›´æ”¹å‡½æ•°ï¼‰ å‡½æ•°ï¼š"),s("code",null,"cdc.fn_cdc_get_net_changes_HumanResources_Department")],-1),R={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-functions/cdc-fn-cdc-get-net-changes-capture-instance-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},I=s("p",null,[n("â€‹ Net changes å‡½æ•°çš„åˆ›å»ºå–å†³äº"),s("code",null,"æ•è·ç¤ºä¾‹"),n("æ–°å»ºæ—¶çš„"),s("code",null,"supports_net_changes"),n("å±æ€§ã€‚")],-1),j=s("p",null,"â€‹ è¿”å›æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å‘ç”Ÿæ›´æ”¹çš„æ¯ä¸ªéé‡å¤è¡Œï¼Œæ­¤å‡½æ•°ä»…è¿”å›ä¸€é¡¹æ›´æ”¹",-1),z=a('<p><img src="'+v+'" alt=""></p><h3 id="_3-2-5-å…ƒæ•°æ®è¡¨" tabindex="-1"><a class="header-anchor" href="#_3-2-5-å…ƒæ•°æ®è¡¨"><span>3.2.5 å…ƒæ•°æ®è¡¨</span></a></h3><p>åœ¨<strong>cdc.change_tables</strong>ï¼Œ<strong>cdc.index_columns</strong>ï¼Œ<strong>cdc.captured_columns</strong> å…ƒæ•°æ®è¡¨ä¸­æ’å…¥ä¿¡æ¯ã€‚</p><h3 id="_3-2-6-ä»£ç†ä½œä¸š" tabindex="-1"><a class="header-anchor" href="#_3-2-6-ä»£ç†ä½œä¸š"><span>3.2.6 ä»£ç†ä½œä¸š</span></a></h3><p>é¦–æ¬¡å¯åŠ¨è¡¨å¯ç”¨å˜æ›´æ•°æ®æ•è·æ—¶ï¼Œä¼šåˆ›å»ºä¸¤ä¸ªå…³è”æ•°æ®åº“çš„SQL Serverä»£ç†ä½œä¸šã€‚æ•è·å’Œæ¸…é™¤ä½œä¸šéƒ½æ˜¯ä½¿ç”¨é»˜è®¤å‚æ•°åˆ›å»ºçš„ã€‚</p><p>â€‹ <img src="'+h+'" alt=""></p><ul><li><p>æ•è·æ›´æ”¹è¡¨ä½œä¸šï¼ˆcaptureï¼‰</p><p>æ•è·ä½œä¸šä¼šç«‹å³å¯åŠ¨ã€‚ å®ƒè¿ç»­è¿è¡Œï¼Œæ¯ä¸ªæ‰«æå‘¨æœŸæœ€å¤šå¯å¤„ç† 1000 ä¸ªäº‹åŠ¡ï¼Œå¹¶åœ¨ä¸¤ä¸ªå‘¨æœŸä¹‹é—´åœé¡¿ 5 ç§’é’Ÿã€‚</p></li><li><p>æ¸…é™¤æ›´æ”¹è¡¨ä½œä¸šï¼ˆcleanupï¼‰</p><p>æ¸…é™¤ä½œä¸šåœ¨æ¯å¤©å‡Œæ™¨ 2 ç‚¹è¿è¡Œä¸€æ¬¡ã€‚ å®ƒå°†æ›´æ”¹è¡¨é¡¹ä¿ç•™ä¸‰å¤©ï¼ˆ4320 åˆ†é’Ÿï¼‰ï¼Œä½¿ç”¨å•ä¸ªåˆ é™¤è¯­å¥æœ€å¤šå¯åˆ é™¤ 5000 é¡¹ã€‚</p></li></ul>',7),U={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-change-job-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},W=a(`<div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> AdventureWorks2016<span class="token punctuation">;</span>  
GO  
<span class="token comment">-- ä¿®æ”¹æ•è·ä½œä¸š</span>
<span class="token keyword">EXECUTE</span> sys<span class="token punctuation">.</span>sp_cdc_change_job   
    <span class="token variable">@job_type</span> <span class="token operator">=</span> N<span class="token string">&#39;capture&#39;</span><span class="token punctuation">,</span>  <span class="token comment">-- ä½œä¸šçš„ç±»å‹</span>
    <span class="token variable">@maxscans</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span>  <span class="token comment">-- ä»æ—¥å¿—ä¸­æå–æ‰€æœ‰è¡Œè€Œè¦æ‰§è¡Œçš„æ‰«æå‘¨æœŸçš„æœ€å¤§æ•°ç›®</span>
    <span class="token variable">@maxtrans</span> <span class="token operator">=</span> <span class="token number">15</span>ï¼Œ  <span class="token comment">-- æ¯ä¸ªæ‰«æå¾ªç¯ä¸­è¦å¤„ç†çš„æœ€å¤§äº‹åŠ¡æ•°</span>
    <span class="token variable">@pollinginterval</span> <span class="token operator">=</span> <span class="token number">5</span>ï¼Œ <span class="token comment">-- æ‰«æé—´éš”ï¼ˆç§’ï¼‰</span>
    <span class="token variable">@continuous</span> <span class="token operator">=</span> <span class="token number">1</span>ï¼› <span class="token comment">-- 1å¾ªç¯è¿è¡Œï¼Œ0åªè¿è¡Œä¸€æ¬¡</span>
GO  
<span class="token comment">-- ä¿®æ”¹æ¸…æ¥šä½œä¸š</span>
<span class="token keyword">EXECUTE</span> sys<span class="token punctuation">.</span>sp_cdc_change_job   
    <span class="token variable">@job_type</span> <span class="token operator">=</span> N<span class="token string">&#39;cleanup&#39;</span><span class="token punctuation">,</span> <span class="token comment">-- ä½œä¸šçš„ç±»å‹</span>
    <span class="token variable">@retention</span> <span class="token operator">=</span> <span class="token number">2880</span><span class="token punctuation">;</span>  <span class="token comment">-- æ›´æ”¹è¡Œè¦åœ¨æ›´æ”¹è¡¨ä¸­ä¿ç•™çš„åˆ†é’Ÿæ•°</span>
GO  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),F={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-help-jobs-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},M={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-tables/dbo-cdc-jobs-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},Q=a(`<div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> AdventureWorks2016<span class="token punctuation">;</span>  
GO  
<span class="token comment">-- æŸ¥è¯¢ä½œä¸š.</span>
<span class="token keyword">EXEC</span> sys<span class="token punctuation">.</span>sp_cdc_help_jobs<span class="token punctuation">;</span>  
GO  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),X={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-start-job-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},B=a(`<div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> AdventureWorks2012<span class="token punctuation">;</span>  
GO  
<span class="token comment">-- å¯åŠ¨æ•è·ä½œä¸šï¼Œå¯ä»¥ä¸æŒ‡å®š job_type çš„å€¼ï¼Œå› ä¸ºé»˜è®¤ä½œä¸šç±»å‹ä¸º &quot; æ•è·&quot;ã€‚</span>
<span class="token keyword">EXEC</span> sys<span class="token punctuation">.</span>sp_cdc_start_job
	<span class="token variable">@job_type</span> <span class="token operator">=</span> N<span class="token string">&#39;capture&#39;</span><span class="token punctuation">;</span>  
GO  
<span class="token comment">-- å¯åŠ¨æ¸…é™¤ä½œä¸šã€‚</span>
<span class="token keyword">EXEC</span> sys<span class="token punctuation">.</span>sp_cdc_start_job 
	<span class="token variable">@job_type</span> <span class="token operator">=</span> N<span class="token string">&#39;cleanup&#39;</span><span class="token punctuation">;</span>  
GO  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),H={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-stop-job-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},P=a(`<div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> AdventureWorks2012<span class="token punctuation">;</span>  
GO  
<span class="token comment">-- åœæ­¢æ•è·ä½œä¸šã€‚</span>
<span class="token keyword">EXEC</span> sys<span class="token punctuation">.</span>sp_cdc_stop_job <span class="token variable">@job_type</span> <span class="token operator">=</span> N<span class="token string">&#39;capture&#39;</span><span class="token punctuation">;</span>  
GO  
<span class="token comment">-- åœæ­¢æ¸…é™¤ä½œä¸šã€‚</span>
<span class="token keyword">EXEC</span> sys<span class="token punctuation">.</span>sp_cdc_stop_job <span class="token variable">@job_type</span> <span class="token operator">=</span> N<span class="token string">&#39;cleanup&#39;</span><span class="token punctuation">;</span>  
GO  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æ³¨æ„</p><p>ä¿®æ”¹ä½œä¸šåï¼Œéœ€è¦é‡å¯ä½œä¸šåæ‰ä¼šç”Ÿæ•ˆã€‚</p><p>å¯åŠ¨å’Œåœæ­¢æ•è·ä½œä¸šå¹¶ä¸ä¼šé€ æˆæ›´æ”¹æ•°æ®ä¸¢å¤±ã€‚ å¯ä»¥åœ¨é«˜å³°éœ€æ±‚æ—¶æ®µç¦æ­¢æ‰«ææ—¥å¿—ä»¥å…å¢åŠ è´Ÿè½½ã€‚</p><p>æ•°æ®åº“å¼•æ“æœåŠ¡æˆ– SQL Server ä»£ç†æœåŠ¡åœ¨ NETWORK SERVICE å¸æˆ·ä¸‹è¿è¡Œæ—¶ï¼Œå˜æ›´æ•°æ®æ•è·æ— æ³•æ­£å¸¸å·¥ä½œã€‚ è¿™å¯èƒ½å¯¼è‡´é”™è¯¯ 22832ã€‚</p></blockquote><h2 id="_3-3-ç¦ç”¨æ•°æ®åº“å˜æ›´æ•°æ®æ•è·-cdc" tabindex="-1"><a class="header-anchor" href="#_3-3-ç¦ç”¨æ•°æ®åº“å˜æ›´æ•°æ®æ•è·-cdc"><span>3.3 ç¦ç”¨æ•°æ®åº“å˜æ›´æ•°æ®æ•è·(CDC)</span></a></h2><p>æ•°æ®åº“ç¦ç”¨å˜æ›´æ•°æ®æ•è·ï¼Œå°†åŒæ—¶åˆ é™¤æ‰€æœ‰å…³è”çš„å˜æ›´æ•°æ®æ•è·å…ƒæ•°æ®ï¼ˆæ‹¬ <strong>cdc</strong> ç”¨æˆ·ã€æ¶æ„å’Œå˜æ›´æ•°æ®æ•è·ä½œä¸šï¼‰ã€‚æ‰€ä»¥ä¸å¿…å…ˆç¦ç”¨å„ä¸ªè¡¨ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token comment">-- ç¦ç”¨æ•°æ®åº“å˜æ›´æ•°æ®æ•è·</span>
<span class="token keyword">USE</span> AdventureWorks2016  
GO  
<span class="token keyword">EXEC</span> sys<span class="token punctuation">.</span>sp_cdc_disable_db  
GO  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-4-ç¦ç”¨è¡¨å˜æ›´æ•°æ®æ•è·" tabindex="-1"><a class="header-anchor" href="#_3-4-ç¦ç”¨è¡¨å˜æ›´æ•°æ®æ•è·"><span>3.4 ç¦ç”¨è¡¨å˜æ›´æ•°æ®æ•è·</span></a></h2><ul><li>å¦‚æœåˆ é™¤äº†å¯ç”¨å˜æ›´æ•°æ®æ•è·çš„è¡¨ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ é™¤ä¸è¯¥è¡¨å…³è”çš„å˜æ›´æ•°æ®æ•è·å…ƒæ•°æ®ã€‚</li><li>å¦‚æœåœ¨ç¦ç”¨å‘ç”Ÿåæ²¡æœ‰å¯¹æ•°æ®åº“å¯ç”¨ä»»ä½•è¡¨ï¼Œåˆ™è¿˜ä¼šåˆ é™¤å˜æ›´æ•°æ®æ•è·ä½œä¸šã€‚</li></ul><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> AdventureWorks2016  
GO  
<span class="token keyword">EXEC</span> sys<span class="token punctuation">.</span>sp_cdc_disable_table  
<span class="token variable">@source_schema</span> <span class="token operator">=</span> N<span class="token string">&#39;dbo&#39;</span><span class="token punctuation">,</span>  
<span class="token variable">@source_name</span>   <span class="token operator">=</span> N<span class="token string">&#39;MyTable&#39;</span><span class="token punctuation">,</span>  
<span class="token variable">@capture_instance</span> <span class="token operator">=</span> N<span class="token string">&#39;dbo_MyTable&#39;</span>  
GO  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-5-ç›‘è§†cdcçŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_3-5-ç›‘è§†cdcçŠ¶æ€"><span>3.5 ç›‘è§†CDCçŠ¶æ€</span></a></h2>`,9),V={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-dynamic-management-views/change-data-capture-sys-dm-cdc-log-scan-sessions?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},$=a(`<p>è‡ª SQL Server æœåŠ¡æœ€åä¸€æ¬¡å¯åŠ¨ä»¥æ¥ï¼Œæ—¥å¿—æ‰«æä¼šè¯çš„çŠ¶æ€ä¿¡æ¯ã€‚æ¯ä¸ªæ—¥å¿—æ‰«æä¼šè¯è®°å½•ä¸€è¡Œï¼Œæœ€åä¸€è¡Œè¡¨ç¤ºå½“å‰ä¼šè¯ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> session_id<span class="token punctuation">,</span> start_time<span class="token punctuation">,</span> end_time<span class="token punctuation">,</span> duration<span class="token punctuation">,</span> scan_phase<span class="token punctuation">,</span>  
    error_count<span class="token punctuation">,</span> start_lsn<span class="token punctuation">,</span> current_lsn<span class="token punctuation">,</span> end_lsn<span class="token punctuation">,</span> tran_count<span class="token punctuation">,</span>  
    last_commit_lsn<span class="token punctuation">,</span> last_commit_time<span class="token punctuation">,</span> log_record_count<span class="token punctuation">,</span> schema_change_count<span class="token punctuation">,</span>  
    command_count<span class="token punctuation">,</span> first_begin_cdc_lsn<span class="token punctuation">,</span> last_commit_cdc_lsn<span class="token punctuation">,</span>   
    last_commit_cdc_time<span class="token punctuation">,</span> latency<span class="token punctuation">,</span> empty_scan_count<span class="token punctuation">,</span> failed_sessions_count  
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>dm_cdc_log_scan_sessions  
<span class="token keyword">WHERE</span> session_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>session_id<span class="token punctuation">)</span> <span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>dm_cdc_log_scan_sessions <span class="token keyword">AS</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>  
GO  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),K={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-dynamic-management-views/change-data-capture-sys-dm-cdc-errors?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},Z=a(`<p>å˜æ›´æ•°æ®æ•è·æ—¥å¿—æ‰«æä¼šè¯ä¸­é‡åˆ°çš„æ¯ä¸ªé”™è¯¯è¿”å›ä¸€è¡Œã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>dm_cdc_errors
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,2),J=s("h1",{id:"_4-æ‰©å±•",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-æ‰©å±•"},[s("span",null,"4 æ‰©å±•")])],-1),Y=s("h2",{id:"_4-1-å…ƒæ•°æ®è¡¨",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-1-å…ƒæ•°æ®è¡¨"},[s("span",null,"4.1 å…ƒæ•°æ®è¡¨")])],-1),ss={id:"cdc-change-tables",tabindex:"-1"},ns={class:"header-anchor",href:"#cdc-change-tables"},es={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-tables/cdc-change-tables-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},ts=s("p",null,"ä¸ºæ•°æ®åº“ä¸­çš„æ¯ä¸ªæ›´æ”¹è¡¨è¿”å›ä¸€è¡Œã€‚ å¯¹æºè¡¨å¯ç”¨å˜æ›´æ•°æ®æ•è·æ—¶ï¼Œå°†åˆ›å»ºä¸€ä¸ªæ›´æ”¹è¡¨ã€‚",-1),as=s("strong",null,"æŸ¥è¯¢ç³»ç»Ÿè¡¨cdc.change_tables",-1),ls={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-help-change-data-capture-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},cs=a("<table><thead><tr><th><strong>cdc.change_tables</strong>ï¼ˆéƒ¨åˆ†åˆ—ï¼‰</th><th></th><th></th></tr></thead><tbody><tr><td><strong>åˆ—åç§°</strong></td><td><strong>æ•°æ®ç±»å‹</strong></td><td><strong>è¯´æ˜</strong></td></tr><tr><td>object_id</td><td>int</td><td>æ›´æ”¹è¡¨çš„ IDã€‚åœ¨æ•°æ®åº“ä¸­æ˜¯å”¯ä¸€çš„ã€‚</td></tr><tr><td>source_object_id</td><td>int</td><td>æ›´æ”¹è¡¨çš„æºè¡¨çš„ IDã€‚</td></tr><tr><td>capture_instance</td><td>sysname</td><td>ç”¨äºå‘½åç‰¹å®šäºå®ä¾‹çš„è·Ÿè¸ªå¯¹è±¡çš„æ•è·å®ä¾‹çš„åç§°ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥åç§°ä»æºæ¶æ„åç§°åŠ ä¸Šæºè¡¨åç§°æ´¾ç”Ÿï¼Œæ ¼å¼ <em>schemaname_sourcename</em>ã€‚</td></tr><tr><td>has_drop_pending</td><td>bit</td><td>æ•è·è¿›ç¨‹æ”¶åˆ°å…³äºæºè¡¨å·²è¢«åˆ é™¤çš„é€šçŸ¥ã€‚</td></tr><tr><td>filegroup_name</td><td>sysname</td><td>æ›´æ”¹è¡¨æ‰€é©»ç•™çš„æ–‡ä»¶ç»„çš„åç§°ã€‚NULL = æ›´æ”¹è¡¨åœ¨æ•°æ®åº“çš„é»˜è®¤æ–‡ä»¶ç»„ä¸­ã€‚</td></tr><tr><td>create_date</td><td>datetime</td><td>å¯ç”¨æºè¡¨çš„æ—¥æœŸã€‚</td></tr><tr><td>partition_switch</td><td>bit</td><td>æŒ‡ç¤ºæ˜¯å¦å¯ä»¥å¯¹å¯ç”¨äº†å˜æ›´æ•°æ®æ•è·çš„è¡¨æ‰§è¡Œ <strong>ALTER TABLE</strong> çš„ <strong>SWITCH PARTITION</strong> å‘½ä»¤ã€‚ 0 æŒ‡ç¤ºåˆ†åŒºåˆ‡æ¢è¢«é˜»æ­¢ã€‚ æœªåˆ†åŒºè¡¨å§‹ç»ˆè¿”å› 1ã€‚</td></tr></tbody></table>",1),ds={id:"cdc-captured-columns",tabindex:"-1"},rs={class:"header-anchor",href:"#cdc-captured-columns"},os={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-tables/cdc-captured-columns-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},is=s("p",null,[s("strong",null,"ä¸ºåœ¨æ•è·å®ä¾‹ä¸­è·Ÿè¸ªçš„æ¯ä¸€åˆ—è¿”å›ä¸€è¡Œã€‚"),n(" é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ºæ•è·æºè¡¨ä¸­çš„æ‰€æœ‰åˆ—ã€‚")],-1),ps=s("strong",null,"ç›´æ¥æŸ¥è¯¢ç³»ç»Ÿè¡¨cdc.captured_columns",-1),us={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-get-captured-columns-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},_s=a("<table><thead><tr><th><strong>cdc.captured_columns</strong></th><th></th><th></th></tr></thead><tbody><tr><td><strong>åˆ—åç§°</strong></td><td><strong>æ•°æ®ç±»å‹</strong></td><td><strong>è¯´æ˜</strong></td></tr><tr><td>object_id</td><td>int</td><td>æ•è·çš„åˆ—æ‰€å±çš„æ›´æ”¹è¡¨çš„ IDã€‚</td></tr><tr><td>column_name</td><td>sysname</td><td>æ•è·çš„åˆ—çš„åç§°ã€‚</td></tr><tr><td>column_id</td><td>int</td><td>æ•è·çš„åˆ—åœ¨æºè¡¨å†…çš„ IDã€‚</td></tr><tr><td>column_type</td><td>sysname</td><td>æ•è·çš„åˆ—çš„ç±»å‹ã€‚</td></tr><tr><td>column_ordinal</td><td>int</td><td>æ›´æ”¹è¡¨ä¸­çš„åˆ—åºå·ï¼ˆä» 1 å¼€å§‹ï¼‰ã€‚ å°†æ’é™¤æ›´æ”¹è¡¨ä¸­çš„å…ƒæ•°æ®åˆ—ã€‚ åºå· 1 å°†åˆ†é…ç»™æ•è·åˆ°çš„ç¬¬ä¸€ä¸ªåˆ—ã€‚</td></tr><tr><td>is_computed</td><td>bit</td><td>è¡¨ç¤ºæ•è·åˆ°çš„åˆ—æ˜¯æºè¡¨ä¸­è®¡ç®—æ‰€å¾—çš„åˆ—ã€‚</td></tr></tbody></table>",1),ms={id:"cdc-ddl-history",tabindex:"-1"},vs={class:"header-anchor",href:"#cdc-ddl-history"},hs={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-tables/cdc-ddl-history-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},bs=s("p",null,[s("strong",null,"ä¸ºå¯¹å¯ç”¨äº†å˜æ›´æ•°æ®æ•è·çš„è¡¨æ‰€åšçš„æ¯ä¸€é¡¹æ•°æ®å®šä¹‰è¯­è¨€ (DDL) æ›´æ”¹è¿”å›ä¸€è¡Œ"),n("ã€‚ å¯ä»¥ä½¿ç”¨æ­¤è¡¨æ¥ç¡®å®šæºè¡¨å‘ç”Ÿ DDL æ›´æ”¹çš„æ—¶é—´ä»¥åŠæ›´æ”¹çš„å†…å®¹ã€‚ æ­¤è¡¨ä¸­ä¸åŒ…å«æœªå‘ç”Ÿ DDL æ›´æ”¹çš„æºè¡¨çš„ä»»ä½•æ¡ç›®ã€‚")],-1),ks=s("strong",null,"ç›´æ¥æŸ¥è¯¢ç³»ç»Ÿè¡¨cdc.ddl_history",-1),gs={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-get-ddl-history-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},ys=a('<table><thead><tr><th style="text-align:left;">cdc.ddl_history</th><th style="text-align:left;"></th><th style="text-align:left;"></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>åˆ—åç§°</strong></td><td style="text-align:left;"><strong>æ•°æ®ç±»å‹</strong></td><td style="text-align:left;"><strong>è¯´æ˜</strong></td></tr><tr><td style="text-align:left;">source_object_id</td><td style="text-align:left;">int</td><td style="text-align:left;">åº”ç”¨ DDL æ›´æ”¹çš„æºè¡¨çš„ IDã€‚</td></tr><tr><td style="text-align:left;">object_id</td><td style="text-align:left;">int</td><td style="text-align:left;">ä¸æºè¡¨çš„æ•è·å®ä¾‹ç›¸å…³è”çš„æ›´æ”¹è¡¨çš„ IDã€‚</td></tr><tr><td style="text-align:left;">required_column_update</td><td style="text-align:left;">bit</td><td style="text-align:left;">æŒ‡ç¤ºåœ¨æºè¡¨ä¸­ä¿®æ”¹äº†æ•è·åˆ—çš„æ•°æ®ç±»å‹ã€‚ æ­¤ä¿®æ”¹æ”¹å˜äº†æ›´æ”¹è¡¨ä¸­çš„åˆ—ã€‚</td></tr><tr><td style="text-align:left;">ddl_command</td><td style="text-align:left;">nvarchar(max)</td><td style="text-align:left;">åº”ç”¨äºæºè¡¨çš„ DDL è¯­å¥ã€‚</td></tr><tr><td style="text-align:left;">ddl_lsn</td><td style="text-align:left;">binary(10)</td><td style="text-align:left;">ä¸ DDL ä¿®æ”¹çš„æäº¤ç›¸å…³è”çš„æ—¥å¿—åºåˆ—å· (LSN)ã€‚</td></tr><tr><td style="text-align:left;">ddl_time</td><td style="text-align:left;">datetime</td><td style="text-align:left;">å¯¹æºè¡¨æ‰€åšçš„ DDL æ›´æ”¹çš„æ—¥æœŸå’Œæ—¶é—´ã€‚</td></tr></tbody></table>',1),fs={id:"cdc-index-columns",tabindex:"-1"},xs={class:"header-anchor",href:"#cdc-index-columns"},qs={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-tables/cdc-index-columns-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},Es=s("p",null,[s("strong",null,"ä¸ºä¸æ›´æ”¹è¡¨å…³è”çš„æ¯ä¸ªç´¢å¼•åˆ—è¿”å›ä¸€è¡Œã€‚å˜æ›´æ•°æ®æ•è·ä½¿ç”¨è¿™äº›ç´¢å¼•åˆ—æ¥å”¯ä¸€æ ‡è¯†æºè¡¨ä¸­çš„è¡Œã€‚")],-1),Cs=s("p",null,"é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†åŒ…æ‹¬æºè¡¨çš„ä¸»é”®åˆ—ã€‚ ä½†æ˜¯ï¼Œå¦‚æœåœ¨å¯¹æºè¡¨å¯ç”¨å˜æ›´æ•°æ®æ•è·æ—¶æŒ‡å®šäº†æºè¡¨çš„å”¯ä¸€ç´¢å¼•ï¼Œåˆ™å°†æ”¹ç”¨è¯¥ç´¢å¼•ä¸­çš„åˆ—ã€‚ å¦‚æœå¯ç”¨å‡€æ›´æ”¹è·Ÿè¸ªï¼Œåˆ™è¯¥æºè¡¨éœ€è¦ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•ã€‚",-1),ws={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sys-sp-cdc-help-change-data-capture-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},Ds=a('<table><thead><tr><th style="text-align:left;">cdc.index_columns</th><th style="text-align:left;"></th><th style="text-align:left;"></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>åˆ—åç§°</strong></td><td style="text-align:left;"><strong>æ•°æ®ç±»å‹</strong></td><td style="text-align:left;"><strong>è¯´æ˜</strong></td></tr><tr><td style="text-align:left;">object_id</td><td style="text-align:left;">int</td><td style="text-align:left;">æ›´æ”¹è¡¨çš„ IDã€‚</td></tr><tr><td style="text-align:left;">column_name</td><td style="text-align:left;">sysname</td><td style="text-align:left;">ç´¢å¼•åˆ—çš„åç§°ã€‚</td></tr><tr><td style="text-align:left;">index_ordinal</td><td style="text-align:left;">tinyint</td><td style="text-align:left;">ç´¢å¼•ä¸­çš„åˆ—åºå·ï¼ˆä» 1 å¼€å§‹ï¼‰ã€‚</td></tr><tr><td style="text-align:left;">column_id</td><td style="text-align:left;">int</td><td style="text-align:left;">æºè¡¨ä¸­çš„åˆ— IDã€‚</td></tr></tbody></table>',1),Ss={id:"cdc-lsn-time-mapping",tabindex:"-1"},Ls={class:"header-anchor",href:"#cdc-lsn-time-mapping"},As={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-tables/cdc-lsn-time-mapping-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},Ns=s("p",null,[s("strong",null,"ä¸ºæ¯ä¸ªåœ¨æ›´æ”¹è¡¨ä¸­å­˜åœ¨è¡Œçš„äº‹åŠ¡è¿”å›ä¸€è¡Œã€‚")],-1),Ts=s("p",null,"è¯¥è¡¨ç”¨äºåœ¨æ—¥å¿—åºåˆ—å· (LSN) æäº¤å€¼å’Œæäº¤äº‹åŠ¡çš„æ—¶é—´ä¹‹é—´å»ºç«‹æ˜ å°„ã€‚ æ²¡æœ‰å¯¹åº”çš„æ›´æ”¹è¡¨é¡¹çš„é¡¹ä¹Ÿå¯ä»¥è®°å½•ä¸‹æ¥ï¼Œ ä»¥ä¾¿è¡¨åœ¨å˜æ›´æ´»åŠ¨å°‘æˆ–è€…æ— å˜æ›´æ´»åŠ¨æœŸé—´å°† LSN å¤„ç†çš„å®Œæˆè¿‡ç¨‹è®°å½•ä¸‹æ¥ã€‚",-1),Os=s("p",null,"ä¸è¦ç›´æ¥æŸ¥è¯¢ç³»ç»Ÿè¡¨ï¼Œ è¯·æ”¹ä¸ºæ‰§è¡Œ",-1),Gs={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-functions/sys-fn-cdc-map-lsn-to-time-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},Rs={href:"https://docs.microsoft.com/zh-cn/sql/relational-databases/system-functions/sys-fn-cdc-map-time-to-lsn-transact-sql?view=sql-server-ver15",target:"_blank",rel:"noopener noreferrer"},Is=a('<table><thead><tr><th style="text-align:left;">cdc.lsn_time_mapping</th><th style="text-align:left;"></th><th style="text-align:left;"></th></tr></thead><tbody><tr><td style="text-align:left;">åˆ—åç§°</td><td style="text-align:left;">æ•°æ®ç±»å‹</td><td style="text-align:left;">è¯´æ˜</td></tr><tr><td style="text-align:left;">start_lsn</td><td style="text-align:left;">binary(10)</td><td style="text-align:left;">æäº¤çš„äº‹åŠ¡çš„ LSNã€‚</td></tr><tr><td style="text-align:left;">tran_begin_time</td><td style="text-align:left;">datetime</td><td style="text-align:left;">ä¸ LSN å…³è”çš„äº‹åŠ¡å¼€å§‹çš„æ—¶é—´ã€‚</td></tr><tr><td style="text-align:left;">tran_end_time</td><td style="text-align:left;">datetime</td><td style="text-align:left;">äº‹åŠ¡ç»“æŸçš„æ—¶é—´ã€‚</td></tr><tr><td style="text-align:left;">tran_id</td><td style="text-align:left;">varbinary (10)</td><td style="text-align:left;">äº‹åŠ¡çš„ IDã€‚</td></tr></tbody></table><h3 id="systranschemas" tabindex="-1"><a class="header-anchor" href="#systranschemas"><span>systranschemas</span></a></h3><p><strong>Systranschemas</strong> è¡¨ç”¨äºè·Ÿè¸ªäº‹åŠ¡å‘å¸ƒå’Œå¿«ç…§å‘å¸ƒä¸­å‘å¸ƒçš„é¡¹ç›®ä¸­çš„æ¶æ„æ›´æ”¹ã€‚ æ­¤è¡¨å­˜å‚¨åœ¨å‘å¸ƒæ•°æ®åº“å’Œè®¢é˜…æ•°æ®åº“ä¸­</p><table><thead><tr><th style="text-align:left;">systranschemas</th><th style="text-align:left;"></th><th style="text-align:left;"></th></tr></thead><tbody><tr><td style="text-align:left;">åˆ—åç§°</td><td style="text-align:left;">æ•°æ®ç±»å‹</td><td style="text-align:left;">è¯´æ˜</td></tr><tr><td style="text-align:left;">tabid</td><td style="text-align:left;">int</td><td style="text-align:left;">æ ‡è¯†å‘ç”Ÿäº†æ¶æ„æ›´æ”¹çš„è¡¨é¡¹ç›®ã€‚</td></tr><tr><td style="text-align:left;">startlsn æ—¶å‘ç”Ÿ</td><td style="text-align:left;">binary</td><td style="text-align:left;">æ¶æ„æ›´æ”¹å¼€å§‹æ—¶çš„ LSN å€¼ã€‚</td></tr><tr><td style="text-align:left;">endlsn</td><td style="text-align:left;">binary</td><td style="text-align:left;">æ¶æ„æ›´æ”¹ç»“æŸæ—¶çš„ LSN å€¼ã€‚</td></tr><tr><td style="text-align:left;">typeid</td><td style="text-align:left;">int</td><td style="text-align:left;">æ¶æ„æ›´æ”¹çš„ç±»å‹ã€‚</td></tr></tbody></table><h3 id="æ›´æ”¹è¡¨-xxxx-ct" tabindex="-1"><a class="header-anchor" href="#æ›´æ”¹è¡¨-xxxx-ct"><span>æ›´æ”¹è¡¨ï¼ˆxxxx_CTï¼‰</span></a></h3><p><strong>æ›´æ”¹è¡¨å……å½“æ•è·è¿›ç¨‹ä»äº‹åŠ¡æ—¥å¿—ä¸­æå–çš„æºè¡¨æ›´æ”¹çš„å­˜å‚¨åº“ã€‚</strong></p><p>å˜æ›´æ•°æ®æ•è·æ›´æ”¹è¡¨çš„å‰äº”åˆ—æ˜¯å…ƒæ•°æ®åˆ—ã€‚ è¿™äº›åˆ—æä¾›ä¸è®°å½•çš„æ›´æ”¹æœ‰å…³çš„é™„åŠ ä¿¡æ¯ã€‚ å…¶ä½™åˆ—é•œåƒæºè¡¨ä¸­æŒ‰åç§°æ ‡è¯†çš„æ•è·åˆ—ï¼ˆé€šå¸¸è¿˜ä¼šæŒ‰ç±»å‹è¿›è¡Œæ ‡è¯†ï¼‰ã€‚ è¿™äº›åˆ—ä¿å­˜ä»æºè¡¨ä¸­æ”¶é›†çš„æ•è·åˆ—æ•°æ®ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p><img src="'+b+'" alt=""></p><table><thead><tr><th style="text-align:left;">systranschemas</th><th style="text-align:left;"></th><th style="text-align:left;"></th></tr></thead><tbody><tr><td style="text-align:left;">åˆ—åç§°</td><td style="text-align:left;">æ•°æ®ç±»å‹</td><td style="text-align:left;">è¯´æ˜</td></tr><tr><td style="text-align:left;">__$start_lsn</td><td style="text-align:left;">binary</td><td style="text-align:left;">æ›´æ”¹æŒ‡å®šçš„æäº¤æ—¥å¿—åºåˆ—å· (LSN)ã€‚æäº¤ LSN ä¸ä»…æ ‡è¯†åœ¨åŒä¸€äº‹åŠ¡ä¸­æäº¤çš„æ›´æ”¹ï¼Œè€Œä¸”è¿˜å¯¹è¿™äº›äº‹åŠ¡è¿›è¡Œæ’åºã€‚</td></tr><tr><td style="text-align:left;">__$end_lsn</td><td style="text-align:left;">binary</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">__$seqval</td><td style="text-align:left;">binary</td><td style="text-align:left;">åŒä¸€äº‹åŠ¡ä¸­è¿›è¡Œçš„æ›´æ”¹æ’åº</td></tr><tr><td style="text-align:left;">__$operation</td><td style="text-align:left;">int</td><td style="text-align:left;">æ›´æ”¹ç›¸å…³çš„æ“ä½œï¼š1 = åˆ é™¤ã€2 = æ’å…¥ã€3 = æ›´æ–°ï¼ˆå‰æ˜ è±¡ï¼‰ã€4 = æ›´æ–°ï¼ˆåæ˜ åƒï¼‰ã€‚</td></tr><tr><td style="text-align:left;">__$update_mask</td><td style="text-align:left;">varbinary</td><td style="text-align:left;">ä¸€ä¸ªå¯å˜çš„ä½æ©ç ï¼Œæ¯ä¸ªæ•è·åˆ—éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å®šä¹‰ä½ã€‚ å¯¹äºæ’å…¥å’Œåˆ é™¤é¡¹ï¼Œæ›´æ–°æ©ç å§‹ç»ˆè®¾å®šæ‰€æœ‰ä½ã€‚ ä½†æ˜¯ï¼Œæ›´æ–°è¡Œä»…è®¾å®šä¸æ›´æ”¹åˆ—å¯¹åº”çš„é‚£äº›ä½</td></tr><tr><td style="text-align:left;">æ•è·æºè¡¨çš„åˆ—...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td></tr></tbody></table><h2 id="_4-2-æ•°æ®å®šä¹‰è¯­è¨€-ddl" tabindex="-1"><a class="header-anchor" href="#_4-2-æ•°æ®å®šä¹‰è¯­è¨€-ddl"><span>4.2 æ•°æ®å®šä¹‰è¯­è¨€ï¼ˆDDLï¼‰</span></a></h2><p><strong>SQLè¯­è¨€é›†ä¸­è´Ÿè´£æ•°æ®ç»“æ„å®šä¹‰ä¸æ•°æ®åº“å¯¹è±¡å®šä¹‰çš„è¯­è¨€ï¼Œç”±CREATEã€ALTERä¸DROPä¸‰ä¸ªè¯­æ³•æ‰€ç»„æˆã€‚</strong></p><ul><li>CREATE DATABASE</li><li>ALTER DATABASE</li><li>CREATE TABLE</li><li>ALTER TABLE</li><li>CREATE INDEX</li><li>DROP INDEX</li><li>...</li></ul><h2 id="_4-3-æ•°æ®æ“çºµè¯­è¨€-dml" tabindex="-1"><a class="header-anchor" href="#_4-3-æ•°æ®æ“çºµè¯­è¨€-dml"><span>4.3 æ•°æ®æ“çºµè¯­è¨€ï¼ˆDML)</span></a></h2><p>â€‹ INSERTã€UPDATEã€DELETEä¸‰ç§æŒ‡ä»¤ã€‚</p><h2 id="_4-4-æ•è·å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#_4-4-æ•è·å®ä¾‹"><span>4.4 æ•è·å®ä¾‹</span></a></h2><ul><li><p>åœ¨ä¸ºæºè¡¨å¯ç”¨å˜æ›´æ•°æ®æ•è·åï¼Œä¼šå¿½ç•¥æºè¡¨çš„ä»»ä½•æ–°åˆ—ã€‚ å¦‚æœåˆ é™¤äº†æŸä¸ªè·Ÿè¸ªçš„åˆ—ï¼Œåˆ™ä¼šä¸ºåœ¨åç»­æ›´æ”¹é¡¹ä¸­ä¸ºè¯¥åˆ—æä¾› Null å€¼ã€‚ä½†æ˜¯ï¼Œå¦‚æœæºè¡¨åˆ—çš„æ•°æ®ç±»å‹å‘ç”Ÿäº†æ›´æ”¹ï¼Œåˆ™è¿™ç§æ›´æ”¹ä¼šä¼ æ’­åˆ°æ›´æ”¹è¡¨ä¸­ã€‚</p></li><li><p>å¯åŒæ—¶ä¸å•ä¸ªæºè¡¨ç›¸å…³è”çš„æœ€å¤§æ•è·å®ä¾‹æ•°ä¸ºä¸¤ä¸ªã€‚</p></li></ul>',17);function js(zs,Us){const e=c("ExternalLinkIcon");return d(),r("div",null,[g,s("blockquote",null,[y,s("p",null,[s("a",f,[n("å˜æ›´æ•°æ®æ•è·(CDC) MSDN"),t(e)])])]),x,s("p",null,[s("a",q,[n("å¯åŠ¨ã€åœæ­¢æˆ–æš‚åœ SQL Server ä»£ç†æœåŠ¡"),t(e)])]),E,s("p",null,[n("ä¸ºæ•°æ®åº“å¯ç”¨â€œæ›´æ”¹æ•°æ®æ•è·â€ï¼Œé€šè¿‡ "),s("a",C,[n("sys.sp_cdc_enable_db (MSDN Transact-SQL)"),t(e)]),n(" å­˜å‚¨è¿‡ç¨‹å®ç°ï¼š")]),w,s("p",null,[n("é€šè¿‡"),s("a",D,[n("sys.sp_cdc_enable_table"),t(e)]),n("å­˜å‚¨è¿‡ç¨‹å®ç°ï¼š")]),S,s("p",null,[n("åˆ›å»ºä¸€ä¸ªæ•è·å®ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨ "),s("a",L,[n("sys.sp_cdc_help_change_data_capture"),t(e)]),n("å­˜å‚¨è¿‡ç¨‹æ¥æ£€ç´¢æ­¤ä¿¡æ¯ã€‚")]),A,s("ul",null,[s("li",null,[N,s("p",null,[n("å‘½åæ–¹å¼ä¸ºï¼š"),s("a",T,[n("cdc.fn_cdc_get_all_changes_<æ•è·å®ä¾‹åç§°>"),t(e)])]),O]),s("li",null,[G,s("p",null,[n("â€‹ å‘½åæ–¹å¼ä¸ºï¼š"),s("a",R,[n("cdc.fn_cdc_get_net_changes_<æ•è·å®ä¾‹åç§°>"),t(e)])]),I,j])]),z,s("p",null,[n("ä¿®æ”¹ä½œä¸šï¼š"),s("a",U,[n("sys.sp_cdc_change_job"),t(e)])]),W,s("p",null,[n("æŸ¥è¯¢ä½œä¸šï¼š"),s("a",F,[n("sys.sp_cdc_help_jobs "),t(e)]),n("æˆ–ç›´æ¥æŸ¥è¯¢"),s("a",M,[n("dbo.cdc_jobs"),t(e)]),n(" è¡¨")]),Q,s("p",null,[n("å¯åŠ¨ä½œä¸šï¼š"),s("a",X,[n("sys.sp_cdc_start_job"),t(e)])]),B,s("p",null,[n("åœæ­¢ä½œä¸šï¼š"),s("a",H,[n("sys.sp_cdc_stop_job"),t(e)])]),P,s("ul",null,[s("li",null,[s("p",null,[s("a",V,[n("sys.dm_cdc_log_scan_sessions"),t(e)])]),$]),s("li",null,[s("p",null,[s("a",K,[n("sys.dm_cdc_errors"),t(e)])]),Z])]),J,Y,s("h3",ss,[s("a",ns,[s("span",null,[s("a",es,[n("cdc.change_tables"),t(e)])])])]),ts,s("p",null,[n("ä¸è¦ç›´æ¥"),as,n("ï¼Œ è¯·æ”¹ä¸ºæ‰§è¡Œ "),s("a",ls,[n("sys.sp_cdc_help_change_data_capture"),t(e)]),n(" å­˜å‚¨è¿‡ç¨‹ã€‚")]),cs,s("h3",ds,[s("a",rs,[s("span",null,[s("a",os,[n("cdc.captured_columns"),t(e)])])])]),is,s("p",null,[n("ä¸è¦ "),ps,n("ã€‚ è¯·æ”¹ä¸ºæ‰§è¡Œ "),s("a",us,[n("sys.sp_cdc_get_source_columns"),t(e)]),n(" å­˜å‚¨è¿‡ç¨‹ã€‚")]),_s,s("h3",ms,[s("a",vs,[s("span",null,[s("a",hs,[n("cdc.ddl_history"),t(e)])])])]),bs,s("p",null,[n("ä¸è¦"),ks,n("ï¼Œ è¯·æ”¹ä¸ºæ‰§è¡Œ "),s("a",gs,[n("sys.sp_cdc_get_ddl_history"),t(e)]),n(" å­˜å‚¨è¿‡ç¨‹ã€‚")]),ys,s("h3",fs,[s("a",xs,[s("span",null,[s("a",qs,[n("cdc.index_columns"),t(e)])])])]),Es,Cs,s("p",null,[n("ä¸è¦ç›´æ¥æŸ¥è¯¢ç³»ç»Ÿè¡¨ï¼Œ è¯·æ”¹ä¸ºæ‰§è¡Œ "),s("a",ws,[n("sys.sp_cdc_help_change_data_capture"),t(e)]),n(" å­˜å‚¨è¿‡ç¨‹ã€‚")]),Ds,s("h3",Ss,[s("a",Ls,[s("span",null,[s("a",As,[n("cdc.lsn_time_mapping"),t(e)])])])]),Ns,Ts,Os,s("p",null,[s("a",Gs,[n("sys.fn_cdc_map_lsn_to_time (transact-sql)"),t(e)]),n(" æˆ– "),s("a",Rs,[n("sys.fn_cdc_map_time_to_lsn (transact-sql)"),t(e)]),n(" ç³»ç»Ÿå‡½æ•°ã€‚")]),Is])}const Fs=l(k,[["render",js],["__file","sqlserver-cdc.html.vue"]]),Ms=JSON.parse('{"path":"/sql-server/sqlserver-cdc.html","title":"SQL Server å˜æ›´æ•°æ®æ•è·ï¼ˆCDCï¼‰","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"2.1 åˆ›å»ºCDCæ–‡ä»¶ç»„","slug":"_2-1-åˆ›å»ºcdcæ–‡ä»¶ç»„","link":"#_2-1-åˆ›å»ºcdcæ–‡ä»¶ç»„","children":[]},{"level":2,"title":"2.2 å¯åŠ¨SQL Serverä»£ç†æœåŠ¡","slug":"_2-2-å¯åŠ¨sql-serverä»£ç†æœåŠ¡","link":"#_2-2-å¯åŠ¨sql-serverä»£ç†æœåŠ¡","children":[]},{"level":2,"title":"2.3 æ£€æŸ¥å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è€…","slug":"_2-3-æ£€æŸ¥å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è€…","link":"#_2-3-æ£€æŸ¥å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è€…","children":[]},{"level":2,"title":"3.1 æ•°æ®åº“å¯ç”¨CDC","slug":"_3-1-æ•°æ®åº“å¯ç”¨cdc","link":"#_3-1-æ•°æ®åº“å¯ç”¨cdc","children":[]},{"level":2,"title":"3.2 è¡¨å¯ç”¨CDC","slug":"_3-2-è¡¨å¯ç”¨cdc","link":"#_3-2-è¡¨å¯ç”¨cdc","children":[{"level":3,"title":"3.2.1 æ•è·å®ä¾‹","slug":"_3-2-1-æ•è·å®ä¾‹","link":"#_3-2-1-æ•è·å®ä¾‹","children":[]},{"level":3,"title":"3.2.2 sys.tablesè§†å›¾","slug":"_3-2-2-sys-tablesè§†å›¾","link":"#_3-2-2-sys-tablesè§†å›¾","children":[]},{"level":3,"title":"3.2.3 æ›´æ”¹è¡¨","slug":"_3-2-3-æ›´æ”¹è¡¨","link":"#_3-2-3-æ›´æ”¹è¡¨","children":[]},{"level":3,"title":"3.2.4 æŸ¥è¯¢å‡½æ•°","slug":"_3-2-4-æŸ¥è¯¢å‡½æ•°","link":"#_3-2-4-æŸ¥è¯¢å‡½æ•°","children":[]},{"level":3,"title":"3.2.5 å…ƒæ•°æ®è¡¨","slug":"_3-2-5-å…ƒæ•°æ®è¡¨","link":"#_3-2-5-å…ƒæ•°æ®è¡¨","children":[]},{"level":3,"title":"3.2.6 ä»£ç†ä½œä¸š","slug":"_3-2-6-ä»£ç†ä½œä¸š","link":"#_3-2-6-ä»£ç†ä½œä¸š","children":[]}]},{"level":2,"title":"3.3 ç¦ç”¨æ•°æ®åº“å˜æ›´æ•°æ®æ•è·(CDC)","slug":"_3-3-ç¦ç”¨æ•°æ®åº“å˜æ›´æ•°æ®æ•è·-cdc","link":"#_3-3-ç¦ç”¨æ•°æ®åº“å˜æ›´æ•°æ®æ•è·-cdc","children":[]},{"level":2,"title":"3.4 ç¦ç”¨è¡¨å˜æ›´æ•°æ®æ•è·","slug":"_3-4-ç¦ç”¨è¡¨å˜æ›´æ•°æ®æ•è·","link":"#_3-4-ç¦ç”¨è¡¨å˜æ›´æ•°æ®æ•è·","children":[]},{"level":2,"title":"3.5 ç›‘è§†CDCçŠ¶æ€","slug":"_3-5-ç›‘è§†cdcçŠ¶æ€","link":"#_3-5-ç›‘è§†cdcçŠ¶æ€","children":[]},{"level":2,"title":"4.1 å…ƒæ•°æ®è¡¨","slug":"_4-1-å…ƒæ•°æ®è¡¨","link":"#_4-1-å…ƒæ•°æ®è¡¨","children":[{"level":3,"title":"cdc.change_tables","slug":"cdc-change-tables","link":"#cdc-change-tables","children":[]},{"level":3,"title":"cdc.captured_columns","slug":"cdc-captured-columns","link":"#cdc-captured-columns","children":[]},{"level":3,"title":"cdc.ddl_history","slug":"cdc-ddl-history","link":"#cdc-ddl-history","children":[]},{"level":3,"title":"cdc.index_columns","slug":"cdc-index-columns","link":"#cdc-index-columns","children":[]},{"level":3,"title":"cdc.lsn_time_mapping","slug":"cdc-lsn-time-mapping","link":"#cdc-lsn-time-mapping","children":[]},{"level":3,"title":"systranschemas","slug":"systranschemas","link":"#systranschemas","children":[]},{"level":3,"title":"æ›´æ”¹è¡¨ï¼ˆxxxx_CTï¼‰","slug":"æ›´æ”¹è¡¨-xxxx-ct","link":"#æ›´æ”¹è¡¨-xxxx-ct","children":[]}]},{"level":2,"title":"4.2 æ•°æ®å®šä¹‰è¯­è¨€ï¼ˆDDLï¼‰","slug":"_4-2-æ•°æ®å®šä¹‰è¯­è¨€-ddl","link":"#_4-2-æ•°æ®å®šä¹‰è¯­è¨€-ddl","children":[]},{"level":2,"title":"4.3 æ•°æ®æ“çºµè¯­è¨€ï¼ˆDML)","slug":"_4-3-æ•°æ®æ“çºµè¯­è¨€-dml","link":"#_4-3-æ•°æ®æ“çºµè¯­è¨€-dml","children":[]},{"level":2,"title":"4.4 æ•è·å®ä¾‹","slug":"_4-4-æ•è·å®ä¾‹","link":"#_4-4-æ•è·å®ä¾‹","children":[]}],"git":{"updatedTime":1709905504000},"filePathRelative":"sql-server/sqlserver-cdc.md"}');export{Fs as comp,Ms as data};
